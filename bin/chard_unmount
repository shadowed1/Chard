#!/bin/bash
STATE_FILE="$CHARD_ROOT/tmp/usb_mount_state"
MOUNT_POINT="/tmp/usb_mount"

if mountpoint -q "$MOUNT_POINT"; then
    sudo umount "$MOUNT_POINT" 2>/dev/null
fi

echo "${CYAN}Restoring:"
while read -r PART MP; do
    echo "${BOLD}  $PART to '$MP' ${RESET}"
    sudo mkdir -p "$MP"
    sudo mount "$PART" "$MP" 2>/dev/null
done < "$STATE_FILE"
sudo rm -f "$STATE_FILE" 2>/dev/null
