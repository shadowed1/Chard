#!/bin/bash
# <<< CHARD_ENV <<<

# <<< CHARD_ROOT_MARKER >>>
CHARD_ROOT=""
CHARD_HOME=""
CHARD_USER=""
# <<< END_CHARD_ROOT_MARKER >>>

#unset LD_PRELOAD

case ":$PATH:" in
    *":$CHARD_ROOT/usr/bin:"*) ;;
    *) PATH="$PATH:$CHARD_ROOT/usr/bin" ;;
esac

case ":$PATH:" in
    *":$CHARD_ROOT/bin:"*) ;;
    *) PATH="$PATH:$CHARD_ROOT/bin" ;;
esac

case ":${LD_LIBRARY_PATH:-}:" in
    *":$CHARD_ROOT/usr/lib:"*) ;;
    *) LD_LIBRARY_PATH="${LD_LIBRARY_PATH:-}:$CHARD_ROOT/usr/lib" ;;
esac

case ":${LD_LIBRARY_PATH:-}:" in
    *":$CHARD_ROOT/lib:"*) ;;
    *) LD_LIBRARY_PATH="${LD_LIBRARY_PATH:-}:$CHARD_ROOT/lib" ;;
esac

export PATH LD_LIBRARY_PATH

if [ -f "/home/chronos/user/.bashrc" ]; then
    if [ -d "/usr/share/fydeos_shell" ]; then
        DEFAULT_BASHRC="$HOME/.bashrc"
        BASHRC_PATH="$DEFAULT_BASHRC"
        IS_CHROMEOS=0
    else
        CHROMEOS_BASHRC="/home/chronos/user/.bashrc"
        BASHRC_PATH="$CHROMEOS_BASHRC"
        IS_CHROMEOS=1
    fi
else
    DEFAULT_BASHRC="$HOME/.bashrc"
    BASHRC_PATH="$DEFAULT_BASHRC"
    IS_CHROMEOS=0
fi

[ -f "$CHARD_ROOT/.chard.env" ] && source "$CHARD_ROOT/.chard.env"
[ -f "$CHARD_ROOT/.chard.logic" ] && source "$CHARD_ROOT/.chard.logic"

#if [ "$IS_CHROMEOS" -eq 1 ]; then
#    [ -f "$CHARD_ROOT/.chard.preload" ] && source "$CHARD_ROOT/.chard.preload"
#fi

chard() {
    case "$1" in
        reinstall)
            bash <(curl -s "https://raw.githubusercontent.com/shadowed1/Chard/main/Gentoo/Reinstall_Chard.sh?$(date +%s)")
            ;;
        *)
            "$CHARD_ROOT/bin/chard" "$@"
            ;;
    esac
}

alias cs='chard safe'
alias cu='chard unmount'
alias cr='chard root'
alias smrt='SMRT'
alias chariot='chard chariot'
alias virtm='sudo -E $CHARD_ROOT/bin/virtm'
alias autoclicker='sudo -E $CHARD_ROOT/bin/autoclicker'
#alias emerge='emerge --root="$CHARD_ROOT" --sysroot="$CHARD_ROOT" --config-root="$CHARD_ROOT" --root-deps=rdeps'
CR="$CHARD_ROOT"
#CH="$CHARD_HOME"

if [[ -f $CHARD_ROOT/usr/bin/.smrt_env.sh ]]; then
    source $CHARD_ROOT/usr/bin/.smrt_env.sh
fi

# <<< END CHARD_ENV <<<
